/* ========================================
   COMPREHENSIVE MOBILE RESPONSIVE FIXES
   For All User Portal Pages
   ======================================== */

/* Base Layout Fixes */
@media (max-width: 768px) {
  /* Prevent horizontal scrolling */
  body {
    overflow-x: hidden;
  }

  /* Portal Layout */
  .user-portal-layout,
  .portal-content,
  .content-wrapper {
    padding: 0.75rem !important;
    width: 100% !important;
    max-width: 100vw !important;
    overflow-x: hidden !important;
  }

  .content-wrapper {
    margin: 0 !important;
  }

  /* Page Headers - Prevent Overflow */
  .page-header {
    padding: 1.5rem 1rem !important;
    margin: 0 -0.75rem 1rem -0.75rem !important;
    width: calc(100% + 1.5rem) !important;
    max-width: none !important;
  }

  .page-title,
  h1 {
    font-size: 1.5rem !important;
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
    hyphens: auto !important;
  }

  .page-subtitle {
    font-size: 0.875rem !important;
  }

  /* Buttons - Stack on Mobile */
  .header-actions,
  .button-group,
  .action-buttons {
    flex-direction: column !important;
    width: 100% !important;
    gap: 0.5rem !important;
  }

  .header-actions button,
  .button-group button,
  .action-buttons button,
  .btn,
  button:not(.icon-button) {
    width: 100% !important;
    min-width: unset !important;
    white-space: nowrap !important;
    padding: 0.75rem 1rem !important;
  }

  /* Stats/Cards Grid - Single Column on Mobile */
  .stats-grid,
  .cards-grid,
  .records-grid,
  .appointments-grid,
  .appointments-grid-modern {
    grid-template-columns: 1fr !important;
    gap: 1rem !important;
    padding: 0 !important;
  }

  /* Individual Cards */
  .stat-card,
  .info-card,
  .record-card,
  .appointment-card,
  .card-modern {
    width: 100% !important;
    max-width: 100% !important;
    margin: 0 !important;
    padding: 1rem !important;
  }

  /* Card Content - Prevent Overflow */
  .card-body,
  .card-content {
    padding: 1rem !important;
  }

  /* Tables - Make Scrollable */
  .table-container,
  .records-table-container {
    overflow-x: auto !important;
    -webkit-overflow-scrolling: touch !important;
    margin: 0 -0.75rem !important;
    width: calc(100% + 1.5rem) !important;
  }

  table {
    min-width: 600px !important;
    font-size: 0.875rem !important;
  }

  table th,
  table td {
    padding: 0.5rem !important;
    white-space: nowrap !important;
  }

  /* Form Rows - Stack on Mobile */
  .form-row,
  .form-grid {
    grid-template-columns: 1fr !important;
    gap: 1rem !important;
  }

  .form-group {
    width: 100% !important;
  }

  /* Input Fields */
  input,
  select,
  textarea {
    width: 100% !important;
    max-width: 100% !important;
    font-size: 16px !important; /* Prevent iOS zoom */
  }

  /* Labels */
  label {
    font-size: 0.875rem !important;
    margin-bottom: 0.5rem !important;
  }

  /* Tabs - Stack Vertically on Small Screens */
  .tabs,
  .tab-list {
    flex-direction: column !important;
    width: 100% !important;
  }

  .tab,
  .tab-button {
    width: 100% !important;
    text-align: center !important;
  }

  /* Detail Rows - Stack on Mobile */
  .detail-row,
  .detail-row-modern,
  .info-row {
    flex-direction: column !important;
    align-items: flex-start !important;
    gap: 0.25rem !important;
  }

  .detail-label {
    width: 100% !important;
  }

  .detail-value {
    width: 100% !important;
    text-align: left !important;
  }

  /* Card Footers - Stack Buttons */
  .card-footer,
  .card-footer-modern,
  .card-actions {
    flex-direction: column !important;
    gap: 0.5rem !important;
  }

  .card-footer button,
  .card-footer-modern button,
  .card-actions button {
    width: 100% !important;
  }

  /* Modals - Full Screen on Mobile */
  .modal,
  .modal-modern,
  .swal2-popup {
    max-width: 95vw !important;
    max-height: 90vh !important;
    margin: auto !important;
  }

  .modal-content,
  .modal-body {
    padding: 1rem !important;
    overflow-y: auto !important;
  }

  /* Chat/Dialog */
  .chat-modal,
  .chat-modal-modern {
    width: 95vw !important;
    max-width: 95vw !important;
    height: 85vh !important;
    max-height: 85vh !important;
  }

  .chat-messages {
    max-height: calc(85vh - 200px) !important;
  }

  /* Type Selector Grid */
  .type-selector-grid {
    grid-template-columns: 1fr !important;
  }

  .type-card {
    padding: 1.5rem !important;
  }

  /* Certificate Section */
  .certificate-request-section {
    flex-direction: column !important;
  }

  .certificate-info {
    flex-direction: column !important;
    align-items: flex-start !important;
  }

  /* Export Buttons */
  .export-buttons,
  .export-btn-group {
    flex-direction: column !important;
    width: 100% !important;
  }

  .export-btn {
    width: 100% !important;
  }
}

/* Extra Small Screens (< 480px) */
@media (max-width: 480px) {
  .user-portal-layout,
  .portal-content,
  .content-wrapper {
    padding: 0.5rem !important;
  }

  .page-header {
    padding: 1rem 0.75rem !important;
  }

  .page-title,
  h1 {
    font-size: 1.25rem !important;
    line-height: 1.3 !important;
  }

  .page-subtitle {
    font-size: 0.8125rem !important;
  }

  .stat-card,
  .info-card,
  .record-card,
  .appointment-card {
    padding: 0.875rem !important;
  }

  .stat-number {
    font-size: 1.75rem !important;
  }

  .stat-label {
    font-size: 0.8125rem !important;
  }

  .card-title {
    font-size: 1rem !important;
  }

  button,
  .btn {
    padding: 0.625rem 0.875rem !important;
    font-size: 0.875rem !important;
  }

  .icon-button {
    width: 36px !important;
    height: 36px !important;
  }

  /* Make text smaller but readable */
  body,
  p,
  .text-body {
    font-size: 0.875rem !important;
  }

  /* Reduce card gaps */
  .stats-grid,
  .cards-grid,
  .records-grid,
  .appointments-grid,
  .appointments-grid-modern {
    gap: 0.75rem !important;
  }

  /* Tighter spacing */
  .form-row,
  .form-grid {
    gap: 0.75rem !important;
  }

  /* Compact table */
  table {
    font-size: 0.8125rem !important;
  }

  table th,
  table td {
    padding: 0.375rem !important;
  }
}

/* Landscape Mobile */
@media (max-width: 896px) and (max-height: 414px) and (orientation: landscape) {
  .page-header {
    padding: 0.75rem 1rem !important;
    margin-bottom: 0.75rem !important;
  }

  .page-title {
    font-size: 1.25rem !important;
  }

  .modal,
  .modal-modern,
  .chat-modal-modern {
    max-height: 85vh !important;
  }

  .chat-messages {
    max-height: calc(85vh - 150px) !important;
  }
}

/* Tablet Portrait (768px - 1024px) */
@media (min-width: 768px) and (max-width: 1024px) {
  .stats-grid,
  .cards-grid {
    grid-template-columns: repeat(2, 1fr) !important;
  }

  .records-grid,
  .appointments-grid-modern {
    grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)) !important;
  }

  .form-row {
    grid-template-columns: repeat(2, 1fr) !important;
  }
}

/* Specific Component Fixes */

/* Appointments Page */
@media (max-width: 768px) {
  .appointments-page .schedule-section,
  .appointments-page .history-section {
    padding-left: 0.75rem !important;
    padding-right: 0.75rem !important;
  }

  .appointment-card-modern {
    padding: 1rem !important;
  }

  .card-header-modern {
    flex-direction: column !important;
    align-items: flex-start !important;
    gap: 0.75rem !important;
  }

  .appointment-type-badge,
  .status-badge {
    font-size: 0.8125rem !important;
    padding: 0.375rem 0.75rem !important;
  }
}

/* Health Records Page */
@media (max-width: 768px) {
  .health-records-page {
    padding: 0.75rem !important;
  }

  .record-card {
    padding: 1rem !important;
  }

  .record-header {
    flex-direction: column !important;
    align-items: flex-start !important;
    gap: 0.5rem !important;
  }

  .record-date {
    font-size: 0.8125rem !important;
  }

  .certificate-card {
    padding: 1rem !important;
  }

  .certificate-list {
    gap: 0.75rem !important;
  }

  .certificate-item {
    flex-direction: column !important;
    align-items: flex-start !important;
    padding: 0.875rem !important;
  }

  .certificate-actions {
    width: 100% !important;
    justify-content: flex-start !important;
    gap: 0.5rem !important;
  }
}

/* User Dashboard */
@media (max-width: 768px) {
  .user-dashboard {
    padding: 0.75rem !important;
  }

  .welcome-section {
    padding: 1.5rem 1rem !important;
  }

  .quick-actions-grid {
    grid-template-columns: 1fr !important;
    gap: 0.75rem !important;
  }

  .action-card {
    padding: 1.25rem !important;
  }

  .upcoming-section {
    padding: 1rem !important;
  }
}

/* Settings Page */
@media (max-width: 768px) {
  .settings-page {
    padding: 0.75rem !important;
  }

  .settings-tabs {
    flex-direction: column !important;
  }

  .settings-tab {
    width: 100% !important;
    text-align: left !important;
  }

  .settings-content {
    padding: 1rem !important;
  }

  .settings-section {
    padding: 1rem !important;
  }
}

/* Fix Navbar on Mobile */
@media (max-width: 768px) {
  .user-navbar {
    padding: 0.75rem 1rem !important;
  }

  .navbar-brand {
    font-size: 1.25rem !important;
  }

  .navbar-menu {
    flex-direction: column !important;
    position: absolute !important;
    top: 100% !important;
    left: 0 !important;
    right: 0 !important;
    background: white !important;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1) !important;
    padding: 1rem !important;
    z-index: 1000 !important;
  }

  .navbar-link {
    width: 100% !important;
    padding: 0.75rem 1rem !important;
    text-align: left !important;
  }
}

/* Utility Classes */
.mobile-only {
  display: none !important;
}

.desktop-only {
  display: block !important;
}

@media (max-width: 768px) {
  .mobile-only {
    display: block !important;
  }

  .desktop-only {
    display: none !important;
  }

  .mobile-hidden {
    display: none !important;
  }

  .mobile-full-width {
    width: 100% !important;
  }
}

/* Fix Text Overflow */
@media (max-width: 768px) {
  * {
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
  }

  .truncate-mobile {
    overflow: hidden !important;
    text-overflow: ellipsis !important;
    white-space: nowrap !important;
  }
}

/* Ensure no element causes horizontal scroll */
@media (max-width: 768px) {
  * {
    max-width: 100% !important;
    box-sizing: border-box !important;
  }

  /* Allow specific elements to be scrollable */
  .table-container,
  .scrollable {
    max-width: none !important;
  }
}
